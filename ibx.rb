#!/usr/bin/env ruby
# vish.erb - template for compiler output to Ruby file.rb
# 

require_relative "/home/edh/dev/vish/runtime/vish_runtime"

### Foreign requires with -r, --require vishc compiler flag(s)
require_relative './util.rb'
require_relative './msg.rb'
require_relative './compose.rb'

###

### Included files with -i, --include vishc compiler flag(s)

###

ctx = Context.new
bc = ByteCodes.new
### emission of bytecodes
bc.codes = [:cls, :pushl, :failure, :pushl, [:msg, :k], :pushl, [:pushv, :msg, :pushl, 1, :pushv, :print, :lcall], :pushl, :Object_2acb4c557f0c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :except, :pushv, :failure, :pushl, 1, :pushv, :curry, :lcall, :assign, :pushl, :mkattr, :pushl, [:k, :v], :pushl, [:pushl, :s, :pushv, :k, :pushl, "!", :pushl, 2, :pushl, :cat, :icall, :pushl, 1, :pushv, :mksym, :lcall, :assign, :pushv, :k, :pushl, [], :pushl, [:pushv, :v], :pushl, :Object_2acb4c556530, :pushl, 3, :pushl, :_mklambda, :icall, :pushl, 2, :pushv, :mkpair, :lcall, :pushv, :s, :pushl, [:x], :pushl, [:pushl, :v, :pushv, :x, :assign, :pushv, :v], :pushl, :Object_2acb4c555554, :pushl, 3, :pushl, :_mklambda, :icall, :pushl, 2, :pushv, :mkpair, :lcall, :pushl, 2, :pushv, :mkobject, :lcall], :pushl, :Object_2acb4c554ce4, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :keys, :pushl, [:obj], :pushl, [:pushv, :obj, :pushl, :keys, :pushl, 2, :pushv, :xmit, :lcall], :pushl, :Object_2acb4c553a4c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :values, :pushl, [:obj], :pushl, [:pushv, :obj, :pushl, :values, :pushl, 2, :pushv, :xmit, :lcall], :pushl, :Object_2acb4c55255c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :car, :pushl, [:l], :pushl, [:pushv, :l, :pushl, 1, :pushv, :key, :lcall], :pushl, :Object_2acb4c54f99c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :cdr, :pushl, [:l], :pushl, [:pushv, :l, :pushl, 1, :pushv, :value, :lcall], :pushl, :Object_2acb4c54ef9c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :undefined?, :pushl, [:key], :pushl, [:pushv, :key, :pushl, 0, :pushv, :binding, :lcall, :pushl, 2, :pushv, :_undefined?, :lcall], :pushl, :Object_2acb4c54dc64, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :map, :pushl, [:coll, :fn], :pushl, [:pushv, :coll, :pushl, 1, :pushv, :empty?, :lcall, :jmprf, 7, :pushl, 0, :pushl, :mkvector, :icall, :fret, :pushv, :coll, :pushl, 1, :pushv, :head, :lcall, :pushl, 1, :pushv, :fn, :lcall, :pushl, 1, :pushl, :mkvector, :icall, :pushv, :coll, :pushl, 1, :pushv, :tail, :lcall, :pushv, :fn, :pushl, 2, :pushv, :map, :lcall, :add], :pushl, :Object_2acb4c549d58, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :__frames, :pushl, 0, :pushl, :mkvector, :icall, :pushl, :frame, :pushl, 1, :pushl, :mkvector, :icall, :pushl, 0, :pushv, :gensym, :lcall, :pushl, 3, :pushv, :_mklambda, :lcall, :assign, :pushl, :unwind_one, :pushl, [:s], :pushl, [:pushv, :s, :pushl, :pop, :pushl, 2, :pushv, :xmit, :lcall, :pushv, :s], :pushl, :Object_2acb4c548a70, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :callcc, :pushl, [:l], :pushl, [:pushl, 0, :pushv, :__frames, :lcall, :pushl, 1, :pushv, :unwind_one, :lcall, :pushv, :callcc, :pushl, 2, :pushv, :_mkcontinuation, :lcall, :pushl, 1, :pushv, :l, :lcall], :pushl, :Object_2acb4c54788c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :null, :pushl, 0, :pushv, :mknull, :lcall, :assign, :pushl, :version, :pushl, 0, :pushv, :version, :lcall, :assign, :pushl, :ifelse, :pushl, [:p, :c, :a], :pushl, [:pushv, :p, :jmprf, 6, :pushl, 0, :pushv, :c, :lcall, :jmprt, 6, :pushl, 0, :pushv, :a, :lcall], :pushl, :Object_2acb4c545a78, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :sh_out, :pushl, [:command], :pushl, [:pushv, :command, :pushl, 1, :pushv, :sh, :lcall, :pushl, 1, :pushv, :head, :lcall], :pushl, :Object_2acb4c544498, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :mkhow, :pushl, [:gkey, :keys, :err], :pushl, [:pushl, :fetch, :pushv, :keys, :pushl, 1, :pushv, :lambda?, :lcall, :pushl, [], :pushl, [:pushv, :keys], :pushl, :Object_2acb4c541630, :pushl, 3, :pushl, :_mklambda, :icall, :pushl, [], :pushl, [:pushl, [:k], :pushl, [:pushv, :keys, :pushv, :k, :index], :pushl, :Object_2acb4c540b7c, :pushl, 3, :pushl, :_mklambda, :icall], :pushl, :Object_2acb4c540884, :pushl, 3, :pushl, :_mklambda, :icall, :pushl, 3, :pushv, :ifelse, :lcall, :assign, :pushl, :what, :pushv, :err, :pushl, 1, :pushv, :raction, :lcall, :assign, :pushl, [], :pushl, [:pushl, 0, :pushv, :gkey, :lcall, :pushl, 1, :pushv, :fetch, :lcall, :pushl, 1, :pushv, :what, :lcall], :pushl, :Object_2acb4c53e958, :pushl, 3, :pushl, :_mklambda, :icall], :pushl, :Object_2acb4c53e2dc, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :quit?, :pushl, [:action], :pushl, [:pushv, :action, :pushl, :quitter, :pushl, 2, :pushv, :has_key?, :lcall], :pushl, :Object_2acb4c53ce00, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :mkquit, :pushl, [], :pushl, [:pushl, :q, :pushl, [:x], :pushl, [:pushl, :quit], :pushl, :Object_2acb4c53c248, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushv, :q, :pushl, :quitter, :pushl, true, :assignx, :pushv, :q], :pushl, :Object_2acb4c53b744, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :dosplit, :pushl, [:arr], :pushl, [:pushv, :arr, :pushl, 1, :pushv, :empty?, :lcall, :jmprf, 6, :pushl, 0, :pushl, :mkvector, :icall, :jmprt, 33, :pushv, :arr, :pushl, 1, :pushv, :head, :lcall, :pushl, "|", :pushl, 2, :pushv, :split, :lcall, :pushl, 1, :pushl, :mkvector, :icall, :pushv, :arr, :pushl, 1, :pushv, :tail, :lcall, :pushl, 1, :pushv, :dosplit, :lcall, :add], :pushl, :Object_2acb4c5375a4, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :map_key, :pushl, [:key], :pushl, [:pushv, :key, :pushl, " ", :eq, :jmprf, 4, :pushl, :space, :fret, :pushv, :key, :pushl, "?", :eq, :jmprf, 4, :pushl, :menu, :fret, :pushv, :key, :pushl, 1, :pushv, :mksym, :lcall], :pushl, :Object_2acb4c535e34, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :help, :pushl, [], :pushl, [:pushl, "q: quit j: down k: up l: line ?: help", :pushl, 1, :pushv, :println, :lcall], :pushl, :Object_2acb4c534de0, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :format, :pushl, [:fmt, :blob, :action], :pushl, [:pushv, :action, :pushl, 1, :pushv, :blob, :lcall, :pushl, 1, :pushv, :fmt, :lcall, :pushl, 1, :pushv, :prints, :lcall], :pushl, :Object_2acb4c530880, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :format, :pushv, :format, :pushl, 1, :pushv, :curry, :lcall, :assign, :pushl, :raction, :pushl, [:err, :action], :pushl, [:pushv, :action, :pushl, 1, :pushv, :undefined?, :lcall, :pushl, [], :pushl, [:pushv, :err], :pushl, :Object_2acb4c52ef6c, :pushl, 3, :pushl, :_mklambda, :icall, :pushl, [], :pushl, [:pushv, :action], :pushl, :Object_2acb4c52e544, :pushl, 3, :pushl, :_mklambda, :icall, :pushl, 3, :pushv, :ifelse, :lcall], :pushl, :Object_2acb4c52d9c8, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :raction, :pushv, :raction, :pushl, 1, :pushv, :curry, :lcall, :assign, :pushl, :repl, :pushl, [:gkey, :keys, :fmt, :err, :hf], :pushl, [:pushl, :fm, :pushv, :fmt, :pushv, :hf, :pushl, 2, :pushv, :format, :lcall, :assign, :pushl, :how, :pushv, :gkey, :pushl, 0, :pushv, :keys, :lcall, :pushv, :err, :pushl, 3, :pushv, :mkhow, :lcall, :assign, :pushl, :ac, :pushl, 0, :pushv, :how, :lcall, :assign, :pushv, :ac, :pushl, 1, :pushv, :quit?, :lcall, :jmprf, 3, :jmpr, 10, :pushv, :ac, :pushl, 1, :pushv, :fm, :lcall, :jmpr, -27], :pushl, :Object_2acb4c528284, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :repl, :pushv, :repl, :pushl, 1, :pushv, :curry, :lcall, :assign, :pushl, :read_inbox, :pushl, [], :pushl, [:pushl, "./load_inbox.sh", :pushl, 1, :pushv, :sh_out, :lcall, :pushl, :lines, :pushl, 2, :pushv, :xmit, :lcall], :pushl, :Object_2acb4c526aec, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :hmove, :pushl, [:hs, :fn], :pushl, [:pushl, :hs, :pushv, :hs, :pushl, 1, :pushv, :fn, :lcall, :assign], :pushl, :Object_2acb4c525ae8, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :hmove, :pushv, :hmove, :pushl, 1, :pushv, :curry, :lcall, :assign, :pushl, :mkeys, :pushl, [], :pushl, [:pushl, :menu, :pushl, [:h], :pushl, [:pushl, 0, :pushv, :help, :lcall, :pushv, :h], :pushl, :Object_2acb4c524864, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :j, :pushl, [:h], :pushl, [:pushv, :h, :pushl, 1, :pushv, :rotatel, :lcall], :pushl, :Object_2acb4c5219e8, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :k, :pushl, [:h], :pushl, [:pushv, :h, :pushl, 1, :pushv, :rotater, :lcall], :pushl, :Object_2acb4c520ee4, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :space, :pushl, [:h], :pushl, [:pushl, "Reading message", :pushl, 1, :pushv, :println, :lcall, :pushl, :fname, :pushv, :h, :pushl, 1, :pushv, :head, :lcall, :pushl, 1, :pushv, :head, :lcall, :assign, :pushv, :fname, :pushl, 1, :pushv, :rmsg, :lcall, :pushl, "Back in Inbox", :pushl, 1, :pushv, :println, :lcall, :pushv, :h], :pushl, :Object_2acb4c51fa1c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :m, :pushl, [:h], :pushl, [:pushl, :x, :pushl, 0, :pushv, :mkmessage, :lcall, :assign, :pushl, "Back in Inbox", :pushl, 1, :pushv, :println, :lcall, :pushv, :h], :pushl, :Object_2acb4c51e3b0, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :L, :pushl, [:h], :pushl, [:pushv, :h], :pushl, :Object_2acb4c51d7d0, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :q, :pushl, 0, :pushv, :mkquit, :lcall, :assign, :pushl, 0, :pushv, :binding, :lcall], :pushl, :Object_2acb4c51c6dc, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :mfmt, :pushl, [:l], :pushl, [:pushv, :l, :pushl, 1, :pushv, :head, :lcall, :pushl, 1, :pushv, :tail, :lcall, :pushl, " ", :pushl, 2, :pushv, :join, :lcall, :pushl, 1, :pushv, :echo, :lcall], :pushl, :Object_2acb4c518a3c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :merr, :pushl, [:l], :pushl, [:pushl, "bad key", :pushl, 1, :pushv, :echo, :lcall, :pushl, 1, :pushv, :printe, :lcall, :pushv, :l], :pushl, :Object_2acb4c51768c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :mget, :pushl, [], :pushl, [:pushl, 0, :pushv, :readc, :lcall, :pushl, 1, :pushv, :map_key, :lcall, :pushl, 1, :pushv, :mksym, :lcall], :pushl, :Object_2acb4c5165fc, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :rget, :pushv, :mget, :assign, :pushl, :rmove, :pushl, [:msg, :fn], :pushl, [:pushv, :msg, :pushl, 1, :pushv, :fn, :lcall], :pushl, :Object_2acb4c5154e0, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :rmove, :pushv, :rmove, :pushl, 1, :pushv, :curry, :lcall, :assign, :pushl, :rkeys, :pushl, [], :pushl, [:pushl, :j, :pushl, [:m], :pushl, [:pushv, :m, :pushl, 1, :pushv, :mrotatel, :lcall], :pushl, :Object_2acb4c511dcc, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :k, :pushl, [:m], :pushl, [:pushv, :m, :pushl, 1, :pushv, :mrotater, :lcall], :pushl, :Object_2acb4c511368, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :L, :pushl, [:m], :pushl, [:pushv, :m, :pushl, 1, :pushv, :mline, :lcall], :pushl, :Object_2acb4c510274, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :g, :pushl, [:m], :pushl, [:pushv, :m, :pushl, 1, :pushv, :mreset, :lcall], :pushl, :Object_2acb4c50f48c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :A, :pushl, [:m], :pushl, [:pushv, :m, :pushl, 1, :pushv, :mrest, :lcall], :pushl, :Object_2acb4c50eadc, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :q, :pushl, 0, :pushv, :mkquit, :lcall, :assign, :pushl, 0, :pushv, :binding, :lcall], :pushl, :Object_2acb4c50d90c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :rfmt, :pushl, [:l], :pushl, [:pushv, :l, :pushl, 1, :pushv, :chomp, :lcall, :pushl, 1, :pushv, :echo, :lcall], :pushl, :Object_2acb4c50c714, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :rerr, :pushl, [:l], :pushl, [:pushl, "bad juju"], :pushl, :Object_2acb4c509d34, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :rshow, :pushl, [:fname], :pushl, [:pushl, ".", :pushl, "/", :pushl, "s", :pushl, "h", :pushl, "o", :pushl, "w", :pushl, "m", :pushl, " ", :pushv, :fname, :pushl, 9, :pushl, :cat, :icall, :pushl, 1, :pushv, :sh_out, :lcall], :pushl, :Object_2acb4c506044, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :rmsg, :pushl, [:fname], :pushl, [:pushl, :contents, :pushv, :fname, :pushl, 1, :pushv, :rshow, :lcall, :assign, :pushl, :buffer, :pushv, :contents, :pushl, :lines, :pushl, 2, :pushv, :xmit, :lcall, :assign, :pushl, :msg, :pushv, :buffer, :pushl, 1, :pushv, :mkmsg, :lcall, :assign, :pushl, :bf, :pushv, :msg, :pushl, 1, :pushv, :rmove, :lcall, :assign, :pushv, :rget, :pushv, :rkeys, :pushv, :rfmt, :pushv, :rerr, :pushv, :bf, :pushl, 5, :pushv, :repl, :lcall], :pushl, :Object_2acb4c5016c0, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :hdrs, :pushl, 0, :pushv, :read_inbox, :lcall, :pushl, 1, :pushv, :dosplit, :lcall, :assign, :pushl, :hf, :pushv, :hdrs, :pushl, 1, :pushv, :hmove, :lcall, :assign, :pushl, :inbox, :pushv, :mget, :pushv, :mkeys, :pushv, :mfmt, :pushv, :merr, :pushl, 4, :pushv, :repl, :lcall, :assign, :pushl, :ibx, :pushl, [], :pushl, [:pushl, "Inbox", :pushl, 1, :pushv, :println, :lcall, :pushl, 0, :pushv, :help, :lcall, :pushv, :hf, :pushl, 1, :pushv, :inbox, :lcall], :pushl, :Object_2acb4c4ffa14, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :_ikeys, :pushl, [], :pushl, [:pushl, :space, :pushl, [:b], :pushl, [:pushv, :b, :pushl, " ", :pushl, 2, :pushv, :buf_ins, :lcall, :pushl, " "], :pushl, :Object_2acb4c4fe808, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :newline, :pushl, [:b], :pushl, [:pushv, :b, :pushl, "\n", :pushl, 1, :pushl, :cat, :icall, :pushl, 2, :pushv, :buf_ins, :lcall, :pushl, "\n", :pushl, 1, :pushl, :cat, :icall], :pushl, :Object_2acb4c4f9b64, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :tab, :pushl, [:b], :pushl, [:pushv, :b, :pushl, " ", :pushl, " ", :pushl, 2, :pushl, :cat, :icall, :pushl, 2, :pushv, :buf_ins, :lcall, :pushl, "tab"], :pushl, :Object_2acb4c4f8084, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :backspace, :pushl, [:b], :pushl, [:pushl, :x, :pushv, :b, :pushl, 1, :pushv, :buf_del, :lcall, :assign, :pushl, "d", :pushl, "e", :pushl, "l", :pushl, "e", :pushl, "t", :pushl, "e", :pushl, " ", :pushv, :x, :pushl, 8, :pushl, :cat, :icall], :pushl, :Object_2acb4c4f6108, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :self_insert, :pushl, [:k, :b], :pushl, [:pushv, :b, :pushv, :k, :pushl, 2, :pushv, :buf_ins, :lcall, :pushv, :k], :pushl, :Object_2acb4c4f3494, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :self_insert, :pushv, :self_insert, :pushl, 1, :pushv, :curry, :lcall, :assign, :pushl, :ctrl_l, :pushl, [:b], :pushl, [:pushv, :b, :pushl, 1, :pushv, :buf_line, :lcall], :pushl, :Object_2acb4c4f1cc0, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :escape, :pushl, [:b], :pushl, [:pushl, true], :pushl, :Object_2acb4c4f10a4, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushv, :escape, :pushl, :quitter, :pushl, true, :assignx, :pushl, 0, :pushv, :binding, :lcall], :pushl, :Object_2acb4c4eeb88, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :ikeys, :pushl, [], :pushl, [:pushl, :k, :pushl, 0, :pushv, :_ikeys, :lcall, :assign, :pushl, [:v], :pushl, [:pushv, :v, :pushl, 1, :pushv, :symbol?, :lcall, :pushl, [], :pushl, [:pushv, :k, :pushv, :v, :index], :pushl, :Object_2acb4c4ec464, :pushl, 3, :pushl, :_mklambda, :icall, :pushl, [], :pushl, [:pushl, :si, :pushv, :k, :pushl, :self_insert, :index, :assign, :pushv, :v, :pushl, 1, :pushv, :si, :lcall], :pushl, :Object_2acb4c49af60, :pushl, 3, :pushl, :_mklambda, :icall, :pushl, 3, :pushv, :ifelse, :lcall], :pushl, :Object_2acb4c49856c, :pushl, 3, :pushl, :_mklambda, :icall], :pushl, :Object_2acb4c496dc0, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :iget, :pushl, [], :pushl, [:pushl, 0, :pushv, :readc, :lcall, :pushl, 1, :pushv, :spec_key, :lcall], :pushl, :Object_2acb4c490d08, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :ierr, :pushl, [:b], :pushl, [:pushl, "key is not bound"], :pushl, :Object_2acb4c48ed64, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :ifmt, :pushl, [:b], :pushl, [:pushv, :b], :pushl, :Object_2acb4c48d270, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :insert, :pushv, :iget, :pushv, :ikeys, :pushv, :ifmt, :pushv, :ierr, :pushl, 4, :pushv, :repl, :lcall, :assign, :pushl, :fmt_send, :pushl, [:draft, :rcpt], :pushl, [:pushl, ".", :pushl, "/", :pushl, "s", :pushl, "e", :pushl, "n", :pushl, "d", :pushl, ".", :pushl, "s", :pushl, "h", :pushl, " ", :pushl, 10, :pushl, :cat, :icall, :pushv, :draft, :pushl, " ", :pushl, 1, :pushl, :cat, :icall, :pushl, 0, :pushv, :rcpt, :pushl, :email, :index, :lcall, :add, :add, :add], :pushl, :Object_2acb4c4803f4, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :fmt_to, :pushl, [:fn], :pushl, [:pushl, "T", :pushl, "o", :pushl, ":", :pushl, " ", :pushl, 0, :pushv, :fn, :pushl, :email, :index, :lcall, :pushl, "\n", :pushl, 6, :pushl, :cat, :icall], :pushl, :Object_2acb4c477e34, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :fmt_date, :pushl, [:fn], :pushl, [:pushl, "D", :pushl, "a", :pushl, "t", :pushl, "e", :pushl, ":", :pushl, " ", :pushl, 0, :pushv, :fn, :lcall, :pushl, "\n", :pushl, 8, :pushl, :cat, :icall], :pushl, :Object_2acb4c472948, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :fmt_subject, :pushl, [:fn], :pushl, [:pushl, "S", :pushl, "u", :pushl, "b", :pushl, "j", :pushl, "e", :pushl, "c", :pushl, "t", :pushl, ":", :pushl, " ", :pushl, 0, :pushv, :fn, :pushl, :subject, :index, :lcall, :pushl, "\n", :pushl, 11, :pushl, :cat, :icall], :pushl, :Object_2acb4c466f94, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :collect_parts, :pushl, [:email, :subject, :body], :pushl, [:pushv, :now_s, :pushl, 1, :pushv, :fmt_date, :lcall, :pushv, :email, :pushl, 1, :pushv, :fmt_to, :lcall, :pushv, :subject, :pushl, 1, :pushv, :fmt_subject, :lcall, :pushl, "\n", :pushl, "\n", :pushl, 2, :pushl, :cat, :icall, :pushv, :body, :pushl, 1, :pushv, :buf_to_s, :lcall, :add, :add, :add, :add], :pushl, :Object_2acb4c45a654, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :sfmt, :pushl, [:s], :pushl, [:pushv, :s], :pushl, :Object_2acb4c455c30, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :send, :pushv, :mget, :pushv, :skeys, :pushv, :sfmt, :pushv, :merr, :pushl, 4, :pushv, :repl, :lcall, :assign, :pushl, :snd, :pushl, [:bmove, :rcpt, :subj], :pushl, [:pushl, :draft, :pushl, "draft", :pushl, 1, :pushv, :mkfname, :lcall, :assign, :pushv, :rcpt, :pushv, :subj, :pushl, [:x], :pushl, [:pushv, :x, :pushl, 1, :pushv, :buf_to_s, :lcall], :pushl, :Object_2acb4c449e08, :pushl, 3, :pushl, :_mklambda, :icall, :pushl, 1, :pushv, :bmove, :lcall, :pushl, 3, :pushv, :collect_parts, :lcall, :pushv, :draft, :pushl, 2, :pushv, :fwrite, :lcall, :pushl, :skeys, :pushl, [], :pushl, [:pushl, :q, :pushl, [:x], :pushl, [:pushl, true], :pushl, :Object_2acb4c44310c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushv, :q, :pushl, :quitter, :pushl, true, :assignx, :pushl, :s, :pushl, [:x], :pushl, [:pushl, "Sending message", :pushl, 1, :pushv, :println, :lcall, :pushv, :draft, :pushv, :rcpt, :pushl, 2, :pushv, :fmt_send, :lcall, :pushl, 1, :pushv, :sh, :lcall, :pushl, "Message sent", :pushl, 1, :pushv, :println, :lcall], :pushl, :Object_2acb4c4357f0, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :d, :pushl, [:b], :pushl, [:pushv, :draft, :pushl, 1, :pushv, :frm, :lcall, :pushv, :draft, :pushl, " file deleted", :add, :pushl, 1, :pushv, :println, :lcall], :pushl, :Object_2acb4c42ddfc, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :c, :pushl, [:x], :pushl, [:pushl, true], :pushl, :Object_2acb4c42790c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushv, :c, :pushl, :quitter, :pushl, true, :assignx, :pushl, :menu, :pushl, [:x], :pushl, [:pushl, "q: quit. s: send. d: Discard draft. c: cancel, leaves draft", :pushl, 1, :pushv, :println, :lcall], :pushl, :Object_2acb4c420b34, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, 0, :pushv, :binding, :lcall], :pushl, :Object_2acb4c41ec6c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :_x, :pushl, 0, :pushv, :skeys, :lcall, :assign, :pushl, 1, :pushl, 1, :pushv, :_x, :pushl, :menu, :index, :lcall, :pushv, :mget, :pushv, :skeys, :pushv, :sfmt, :pushv, :merr, :pushv, :bmove, :pushl, 5, :pushv, :repl, :lcall], :pushl, :Object_2acb4c4161c0, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :cmove, :pushl, [:buf, :fn], :pushl, [:pushv, :buf, :pushl, 1, :pushv, :fn, :lcall], :pushl, :Object_2acb4c4100f4, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :cmove, :pushv, :cmove, :pushl, 1, :pushv, :curry, :lcall, :assign, :pushl, :cget, :pushv, :mget, :assign, :pushl, :ckeys, :pushl, [], :pushl, [:pushl, :h, :pushl, [:b], :pushl, [:pushv, :b, :pushl, 1, :pushv, :buf_back, :lcall, :pushv, :b, :pushl, 1, :pushv, :buf_at, :lcall], :pushl, :Object_2acb4c408714, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :j, :pushl, [:b], :pushl, [:pushv, :b, :pushl, 1, :pushv, :buf_down, :lcall, :pushv, :b, :pushl, 1, :pushv, :buf_line, :lcall], :pushl, :Object_2acb4c401798, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :k, :pushl, [:b], :pushl, [:pushv, :b, :pushl, 1, :pushv, :buf_up, :lcall, :pushv, :b, :pushl, 1, :pushv, :buf_line, :lcall], :pushl, :Object_2acb4c3fcb80, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :l, :pushl, [:b], :pushl, [:pushv, :b, :pushl, 1, :pushv, :buf_fwd, :lcall, :pushv, :b, :pushl, 1, :pushv, :buf_at, :lcall], :pushl, :Object_2acb4c3f7900, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :g, :pushl, [:b], :pushl, [:pushv, :b, :pushl, 1, :pushv, :buf_beg, :lcall, :pushv, :b, :pushl, 1, :pushv, :buf_line, :lcall], :pushl, :Object_2acb4c3f1230, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :G, :pushl, [:b], :pushl, [:pushv, :b, :pushl, 1, :pushv, :buf_fin, :lcall, :pushv, :b, :pushl, 1, :pushv, :buf_line, :lcall], :pushl, :Object_2acb4c3e9864, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :L, :pushl, [:b], :pushl, [:pushv, :b, :pushl, 1, :pushv, :buf_line, :lcall], :pushl, :Object_2acb4c3e7d20, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :i, :pushl, [:b], :pushl, [:pushl, "insert mode", :pushl, 1, :pushv, :printe, :lcall, :pushv, :b, :pushl, 1, :pushv, :cmove, :lcall, :pushl, 1, :pushv, :insert, :lcall, :pushl, "command mode"], :pushl, :Object_2acb4c3df738, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :q, :pushl, 0, :pushv, :mkquit, :lcall, :assign, :pushl, 0, :pushv, :binding, :lcall], :pushl, :Object_2acb4c3d8a78, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :cfmt, :pushl, [:s], :pushl, [:pushv, :s], :pushl, :Object_2acb4c3d6214, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :cerr, :pushl, [:l], :pushl, [:pushl, "bad key", :pushl, 1, :pushv, :echo, :lcall, :pushl, 1, :pushv, :printe, :lcall, :pushl, ""], :pushl, :Object_2acb4c3d03b4, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :mkrcpt, :pushl, [], :pushl, [:pushl, :to1, :pushl, "", :assign, :pushl, :email, :pushl, [], :pushl, [:pushv, :to1], :pushl, :Object_2acb4c3cbf30, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :email!, :pushl, [:a], :pushl, [:pushl, :to1, :pushv, :a, :assign], :pushl, :Object_2acb4c3c8f9c, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, 0, :pushv, :binding, :lcall], :pushl, :Object_2acb4c3c4348, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :mksubject, :pushl, [], :pushl, [:pushl, :subj, :pushl, "", :assign, :pushl, :subject, :pushl, [], :pushl, [:pushv, :subj], :pushl, :Object_2acb4c3c05b8, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :subject!, :pushl, [:a], :pushl, [:pushl, :subj, :pushv, :a, :assign], :pushl, :Object_2acb4c3bbdec, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, 0, :pushv, :binding, :lcall], :pushl, :Object_2acb4c3b96f0, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, :mkmessage, :pushl, [], :pushl, [:pushl, "New message", :pushl, 1, :pushv, :print, :lcall, :pushl, "to: ", :pushl, 1, :pushv, :prints, :lcall, :pushl, :email, :pushl, 0, :pushv, :mkrcpt, :lcall, :assign, :pushl, 0, :pushv, :read, :lcall, :pushl, 1, :pushv, :email, :pushl, :email!, :index, :lcall, :pushl, " Subject: ", :pushl, 1, :pushv, :prints, :lcall, :pushl, :subject, :pushl, 0, :pushv, :mksubject, :lcall, :assign, :pushl, 0, :pushv, :read, :lcall, :pushl, 1, :pushv, :subject, :pushl, :subject!, :index, :lcall, :pushl, :buf, :pushl, "", :pushl, 1, :pushv, :mkbuf, :lcall, :assign, :pushl, :bmove, :pushv, :buf, :pushl, 1, :pushv, :cmove, :lcall, :assign, :pushl, "Message body: Enter q to quit", :pushl, 1, :pushv, :prints, :lcall, :pushv, :cget, :pushv, :ckeys, :pushv, :cfmt, :pushv, :cerr, :pushv, :bmove, :pushl, 5, :pushv, :repl, :lcall, :pushv, :bmove, :pushv, :email, :pushv, :subject, :pushl, 3, :pushv, :snd, :lcall, :pushl, 0, :pushv, :email, :pushl, :email, :index, :lcall, :pushl, 0, :pushv, :subject, :pushl, :subject, :index, :lcall, :pushv, :buf, :pushl, 1, :pushv, :buf_to_s, :lcall, :pushl, 3, :pushl, :mkvector, :icall], :pushl, :Object_2acb4c3a1104, :pushl, 3, :pushl, :_mklambda, :icall, :assign, :pushl, 0, :pushv, :ibx, :lcall, :halt]
###
ci = CodeInterpreter.new bc, ctx

# Main
p ci.run
